<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="ProduceMaterial" xmlns="http://ibatis.apache.org/mapping"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <statements>
    <select id="selectbypronoteHeaderId" resultMap="ProduceMaterialResult" parameterClass="string">
      SELECT * FROM ProduceMaterial WHERE PronoteHeaderID=#value#
    </select>
    <select id="selectByDateRage" resultMap="ProduceMaterialResult" parameterClass="Map">
      SELECT * FROM ProduceMaterial where ProduceMaterialDate between #startdate# and #enddate# order by ProduceMaterialId desc
    </select>
    <select id="select_byState" parameterClass="int" resultMap="ProduceMaterialResult">
      <![CDATA[
      select * from ProduceMaterial
				where DepotOutState<>2 or DepotOutState is null
      ]]>
    </select>
	  <select id="existsId" resultClass="bool" parameterClass="string">
		  <![CDATA[
			select case when exists(
				select * 
				from dbo.ProduceMaterial
				where ProduceMaterialID=#value#
				) 
				then 1 else 0 end
			]]>
	  </select>
	  <select id="selectBycondition"  resultMap="ProduceMaterialResult" prameterClass="Map">
		  <![CDATA[
		   SELECT * FROM ProduceMaterial  pm WHERE ((pm.ProduceMaterialDate>=#starDate# OR #starDate# IS NULL) AND (pm.ProduceMaterialDate<=#endDate# OR #endDate# IS NULL))
      AND ((pm.ProduceMaterialID>=#produceMaterialId0# OR #produceMaterialId0# IS NULL) AND (pm.ProduceMaterialID<=#produceMaterialId1# OR #produceMaterialId1# IS NULL))
      AND  ProduceMaterialID in(select ProduceMaterialID from ProduceMaterialdetails where productid IN (SELECT ProductId FROM Product WHERE (Id>=#pId0# OR #pId0# IS NULL) AND (Id<=#pId1# OR #pId1# IS NULL)))
      AND (pm.WorkHouseId= #dId0# or #dId0# is null) 
	  AND (pm.PronoteHeaderID>=#pronoteId0# OR #pronoteId0# IS NULL) AND (pm.PronoteHeaderID<=#pronoteId1# OR #pronoteId1# IS NULL)
      ]]>
	  </select>
  </statements>
</sqlMap>